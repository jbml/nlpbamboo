#!/bin/sh -x
TAG="people-daily"
TOP=$(dirname $(which $0))/..
RAW="$TOP/data_raw/${TAG}.txt"
if [ ! -r "$RAW" ]; then
	echo "can not find $RAWDIR/${TAG}.txt" >&2
	exit 1
fi
BUILD_DIR=$TOP/data_build
INDEX_DIR=$TOP/index
mkdir -p $BUILD_DIR
mkdir -p $INDEX_DIR
$TOP/bin/ngm_tool -s $RAW > ${BUILD_DIR}/${TAG}.sentences.txt
$TOP/bin/ngm_tool -w ${BUILD_DIR}/${TAG}.sentences.txt > ${BUILD_DIR}/${TAG}.ugm.txt
$TOP/bin/ngm_tool -b ${BUILD_DIR}/${TAG}.sentences.txt > ${BUILD_DIR}/${TAG}.bgm.txt
cat ${BUILD_DIR}/${TAG}.ugm.txt | $TOP/bin/make_turing_data > ${BUILD_DIR}/${TAG}.ugm.sgt.txt
cat ${BUILD_DIR}/${TAG}.bgm.txt | $TOP/bin/make_turing_data > ${BUILD_DIR}/${TAG}.bgm.sgt.txt

$TOP/bin/lexicon_cli -b -i ${INDEX_DIR}/${TAG}.ugm.idx -s ${BUILD_DIR}/${TAG}.ugm.txt
$TOP/bin/lexicon_cli -b -i ${INDEX_DIR}/${TAG}.bgm.idx -s ${BUILD_DIR}/${TAG}.bgm.txt
$TOP/bin/lexicon_cli -b -i ${INDEX_DIR}/${TAG}.ugm.sgt.idx -s ${BUILD_DIR}/${TAG}.ugm.sgt.txt
$TOP/bin/lexicon_cli -b -i ${INDEX_DIR}/${TAG}.bgm.sgt.idx -s ${BUILD_DIR}/${TAG}.bgm.sgt.txt

